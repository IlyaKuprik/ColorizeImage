# ColorizeImage
 Тема раскраски ЧБ фотографий меня заинтересовала, потому что я сам немного занимаюсь пленочной фотографией, и в целом мне стало интересно, как выглядели улицы городов 70-100 лет назад в цвете. Поэтому для итогового проекта по курсу "Введение в Искуственный Интелект" я решил написать программу на основе нейронной сети, которая будет раскрашивать фотографии.
## Представление изображения
Все знают, что изображения представляются в формате RGB, и сначала я думал работать с RGB представлением, но в таком случае пришлось бы предсказывать 3 слоя по черно-белому изображению. Для задачи колоризации гораздо лучше использовать цветовое пространство LAB.
В этом цветовом пространстве в качестве одного из слоев используется lightness слой, то есть “светлота” картинки.

Этот слой как раз выглядит как ЧБ представление, поэтому, работая в цветовом пространстве LAB нужно будет предсказывать только слои A и B.
Слой А отвечает за положение цвета от зеленого до красного, а B - от синего до желтого. 

Также ученые доказали, что только 6 процентов рецепторов сетчатки глаза отвечают за определение цвета, а остальные - за определение яркости. Поэтому невозможно было отказаться от выбора цветового пространства LAB.
## Датасет
Далее, расскажу про датасет и возникшие проблемы. 

У меня сразу не было цели, чтобы нейронная сеть хорошо обобщала данные и раскрашивала любые фотографии. Я решил сфокусироваться на фото переулков, домов, кварталов. В открытом доступе я не нашел большого количества данных, поэтому датасет пришлось делать самому.

Сначала я просто скачал около *четырех тысяч фотографий* улиц родного города, но, ничего хорошего из этого не вышло, так как данные были плохо распределены, да и в целом было много разного мусора и шума. После неудачной попытки с помощью утилиты [Yandex-Grabber](http://ufahameleon.ru/soft.aspx?id=2) я скачивал большое количество разных фотографий, среди которых были фото деревьев, неба, улиц, советской архитектуры и трамваев. Трамваи мне захотелось добавить, потому что на ретро-снимках я видел их достаточно часто.

Размер обучающих данных я выбрал 128x128 пикселей, так как при большей размерности обучение длилось бы достаточно долго. 
